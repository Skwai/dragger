{"version":3,"file":"index.min.js","sources":["../src/index.js"],"sourcesContent":["// https://jsfiddle.net/tovic/Xcb8d/\n\nconst DEFAULTS = {\n  placeholderClassName: \"placeholder\",\n  draggableSelector: null\n};\n\nexport default class Dragger {\n  constructor({ element, opts = {} }) {\n    if (!(element instanceof Node)) {\n      throw Error(\"`element` is not an instance of `Node`\");\n    }\n\n    Object.assign(this, {\n      element,\n      opts: Object.assign({}, DEFAULTS, opts),\n      handleElement: null,\n      placeholderElement: null\n    });\n\n    this.handleMouseUp = this.handleMouseUp.bind(this);\n    this.handleMouseDown = this.handleMouseDown.bind(this);\n    this.handleMouseMove = this.handleMouseMove.bind(this);\n\n    this.bindDraggableElements();\n  }\n\n  handleMouseUp(ev) {\n    this.reset();\n  }\n\n  handleMouseDown({ target }) {\n    this.init(target);\n  }\n\n  positionHandle({ clientX, clientY }) {\n    const { placeholderElement, handleElement, element } = this;\n    const c = element.getBoundingClientRect();\n    const p = placeholderElement.getBoundingClientRect();\n    const x = (() => {\n      const pos = clientX - p.width / 2; // clientX - c.left + p.left;\n      if (pos < c.left) return c.left;\n      if (pos > c.right - p.width) return c.right - p.width;\n      return pos;\n    })();\n    const y = (() => {\n      const pos = clientY - p.height;\n      if (pos < c.top) return c.top;\n      if (pos > c.bottom) return c.bottom - p.height\n      return pos;\n    })();\n    window.requestAnimationFrame(() => {\n      Object.assign(handleElement.style, {\n        position: \"absolute\",\n        width: `${p.width}px`,\n        height: `${p.height}px`,\n        left: `${x}px`,\n        top: `${y}px`\n      });\n    });\n  }\n\n  init(element) {\n    const placeholder = this.placeholderElement = element;\n    const handle = this.handleElement = placeholder.cloneNode(true);\n\n    const { left, top, width, height } = placeholder.getBoundingClientRect();\n    placeholder.parentNode.appendChild(handle);\n    placeholder.classList.add(this.opts.placeholderClassName);\n    Object.assign(handle.style, {\n      position: \"absolute\",\n      width: `${width}px`,\n      height: `${height}px`\n    });\n  }\n\n  reset() {\n    const { handleElement, placeholderElement } = this;\n    if (!(handleElement instanceof Node)) return;\n    placeholderElement.classList.remove(\"placeholder\");\n    this.placeholderElement = null;\n    handleElement.parentNode.removeChild(handleElement)\n    this.handleElement = null;\n  }\n\n  handleMouseMove({ clientX, clientY }) {\n    if (!(this.handleElement instanceof Node)) return;\n    this.positionHandle({ clientX, clientY });\n  }\n\n  getDraggableElements() {\n    if (this.children) return this.children;\n    this.children = this.opts.draggableSelector ? this.element.querySelectorAll(this.opts.draggableSelector) : this.element.children;\n    return this.children;\n  }\n\n  bindDraggableElements() {\n    const children = this.getDraggableElements();\n    Array.from(children).forEach((el) => {\n      const { position } = el.style;\n      if (!position || position === \"static\") el.style.position = \"relative\";\n      el.addEventListener('mousedown', this.handleMouseDown);\n      document.addEventListener('mousemove', this.handleMouseMove);\n      document.addEventListener('mouseup', this.handleMouseUp);\n    });\n  }\n};"],"names":["DEFAULTS","element","opts","Node","Error","assign","this","Object","handleMouseUp","bind","handleMouseDown","handleMouseMove","bindDraggableElements","ev","reset","target","init","clientX","clientY","placeholderElement","handleElement","c","getBoundingClientRect","p","x","pos","width","left","right","y","height","top","bottom","requestAnimationFrame","style","placeholder","handle","cloneNode","parentNode","appendChild","classList","add","placeholderClassName","remove","removeChild","positionHandle","children","draggableSelector","querySelectorAll","getDraggableElements","from","forEach","el","position","addEventListener","_this"],"mappings":";;;;;;2gBAEMA,wBACkB,gCACH,yCAILC,KAAAA,YAASC,KAAAA,iCACfD,YAAmBE,YACjBC,OAAM,iDAGPC,OAAOC,qBAENC,OAAOF,UAAWL,EAAUE,iBACnB,wBACK,YAGjBM,cAAgBF,KAAKE,cAAcC,KAAKH,WACxCI,gBAAkBJ,KAAKI,gBAAgBD,KAAKH,WAC5CK,gBAAkBL,KAAKK,gBAAgBF,KAAKH,WAE5CM,wEAGOC,QACPC,sDAGWC,KAAAA,YACXC,KAAKD,gDAGKE,KAAAA,QAASC,IAAAA,QAChBC,EAA+Cb,KAA/Ca,mBAAoBC,EAA2Bd,KAA3Bc,cAAenB,EAAYK,KAAZL,QACrCoB,EAAIpB,EAAQqB,wBACZC,EAAIJ,EAAmBG,wBACvBE,EAAK,cACHC,GAAMR,EAAUM,EAAEG,MAAQ,QAC5BD,GAAMJ,EAAEM,KAAaN,EAAEM,KACvBF,EAAMJ,EAAEO,MAAQL,EAAEG,MAAcL,EAAEO,MAAQL,EAAEG,MACzCD,KAEHI,EAAK,cACHJ,GAAMP,EAAUK,EAAEO,aACpBL,GAAMJ,EAAEU,IAAYV,EAAEU,IACtBN,EAAMJ,EAAEW,OAAeX,EAAEW,OAAST,EAAEO,OACjCL,YAEFQ,sBAAsB,kBACpB5B,OAAOe,EAAcc,gBAChB,iBACAX,EAAEG,kBACDH,EAAEO,iBACJN,WACDK,wCAKT5B,MACGkC,GAAc7B,KAAKa,mBAAqBlB,EACxCmC,EAAS9B,KAAKc,cAAgBe,EAAYE,WAAU,KAErBF,EAAYb,wBAA9BI,KAAXC,OAAMI,MAAKL,OAAOI,IAAAA,SACdQ,WAAWC,YAAYH,KACvBI,UAAUC,IAAInC,KAAKJ,KAAKwC,6BAC7BrC,OAAO+B,EAAOF,gBACT,iBACAR,cACCI,4CAKLV,GAAsCd,KAAtCc,cAAeD,EAAuBb,KAAvBa,kBACjBC,aAAyBjB,UACZqC,UAAUG,OAAO,oBAC/BxB,mBAAqB,OACZmB,WAAWM,YAAYxB,QAChCA,cAAgB,oDAGLH,KAAAA,QAASC,IAAAA,OACnBZ,MAAKc,wBAAyBjB,YAC/B0C,gBAAiB5B,UAASC,iEAI3BZ,MAAKwC,SAAiBxC,KAAKwC,eAC1BA,SAAWxC,KAAKJ,KAAK6C,kBAAoBzC,KAAKL,QAAQ+C,iBAAiB1C,KAAKJ,KAAK6C,mBAAqBzC,KAAKL,QAAQ6C,SACjHxC,KAAKwC,qEAINA,EAAWxC,KAAK2C,6BAChBC,KAAKJ,GAAUK,QAAQ,SAACC,MACpBC,GAAaD,EAAGlB,MAAhBmB,QACHA,IAAyB,WAAbA,IAAuBD,EAAGlB,MAAMmB,SAAW,cACzDC,iBAAiB,YAAaC,EAAK7C,0BAC7B4C,iBAAiB,YAAaC,EAAK5C,0BACnC2C,iBAAiB,UAAWC,EAAK/C"}