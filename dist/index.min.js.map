{"version":3,"file":"index.min.js","sources":["../src/index.js"],"sourcesContent":["// https://jsfiddle.net/tovic/Xcb8d/\n\nconst DEFAULTS = {\n  placeholderClassName: \"placeholder\",\n  draggableSelector: null\n};\n\nexport default class Dragger {\n  constructor({ element, opts = {} }) {\n    if (!(element instanceof Node)) {\n      throw Error(\"`element` is not an instance of `Node`\");\n    }\n\n    Object.assign(this, {\n      element,\n      opts: Object.assign({}, DEFAULTS, opts),\n      handleElement: null,\n      placeholderElement: null,\n      placeholderPosition: { top: 0, left: 0 }      \n    });\n\n    this.handleMouseUp = this.handleMouseUp.bind(this);\n    this.handleMouseDown = this.handleMouseDown.bind(this);\n    this.handleMouseMove = this.handleMouseMove.bind(this);\n\n    this.bindDraggableElements();\n  }\n\n  handleMouseUp(ev) {\n    this.reset();\n  }\n\n  handleMouseDown({ target }) {\n    this.placeholderElement = target; \n    this.placeholderElement.classList.add(\"placeholder\");\n\n    const placeholder = target;\n    const handle = document.importNode(placeholder, true); // .cloneNode(true);\n    placeholder.parentNode.appendChild(handle);\n    const { left, top, width, height } = target.getBoundingClientRect();\n\n    placeholder.classList.add(this.opts.placeholderClassName);\n    Object.assign(handle.style, {\n      position: \"absolute\",\n      width: `${width}px`,\n      height: `${height}px`\n    });\n\n    Object.assign(this.placeholderPosition, { left, top });\n    this.placeholderElement = placeholder;\n    this.handleElement = handle;\n  }\n\n  positionHandle({ clientX, clientY }) {\n    window.requestAnimationFrame(() => {\n      const el = this.handleElement;\n      const { left, top } = this.placeholderPosition;\n      const x = clientX - left;\n      const y = clientY - top;\n      Object.assign(el.style, {\n        left: `${x}px`,\n        top: `${y}px`\n      });\n    });\n  }\n\n  reset() {\n    const { handleElement, placeholderElement } = this;\n    if (!(handleElement instanceof Node)) return;\n    placeholderElement.classList.remove(\"placeholder\");\n    this.placeholderElement = null;\n    handleElement.parentNode.removeChild(handleElement)\n    this.handleElement = null;\n  }\n\n  handleMouseMove({ clientX, clientY }) {\n    if (!(this.handleElement instanceof Node)) return;\n    this.positionHandle({ clientX, clientY });\n  }\n\n  getDraggableElements() {\n    if (this.children) return this.children;\n    this.children = this.opts.draggableSelector ? this.element.querySelectorAll(this.opts.draggableSelector) : this.element.children;\n    return this.children;\n  }\n\n  bindDraggableElements() {\n    const children = this.getDraggableElements();\n    Array.from(children).forEach((el) => {\n      const { position } = el.style;\n      if (!position || position === \"static\") el.style.position = \"relative\";\n      el.addEventListener('mousedown', this.handleMouseDown);\n      document.addEventListener('mousemove', this.handleMouseMove);\n      document.addEventListener('mouseup', this.handleMouseUp);\n    });\n  }\n};"],"names":["DEFAULTS","element","opts","Node","Error","assign","this","Object","top","left","handleMouseUp","bind","handleMouseDown","handleMouseMove","bindDraggableElements","ev","reset","target","placeholderElement","classList","add","placeholder","handle","document","importNode","parentNode","appendChild","getBoundingClientRect","width","height","placeholderClassName","style","placeholderPosition","handleElement","clientX","clientY","requestAnimationFrame","el","_this","x","y","remove","removeChild","positionHandle","children","draggableSelector","querySelectorAll","getDraggableElements","from","forEach","position","addEventListener","_this2"],"mappings":";;;;;;2gBAEMA,wBACkB,gCACH,yCAILC,KAAAA,YAASC,KAAAA,iCACfD,YAAmBE,YACjBC,OAAM,iDAGPC,OAAOC,qBAENC,OAAOF,UAAWL,EAAUE,iBACnB,wBACK,0BACGM,IAAK,EAAGC,KAAM,UAGlCC,cAAgBJ,KAAKI,cAAcC,KAAKL,WACxCM,gBAAkBN,KAAKM,gBAAgBD,KAAKL,WAC5CO,gBAAkBP,KAAKO,gBAAgBF,KAAKL,WAE5CQ,wEAGOC,QACPC,sDAGWC,KAAAA,YACXC,mBAAqBD,OACrBC,mBAAmBC,UAAUC,IAAI,kBAEhCC,GAAcJ,EACdK,EAASC,SAASC,WAAWH,GAAa,KACpCI,WAAWC,YAAYJ,SACEL,EAAOU,wBAApClB,IAAAA,KAAMD,IAAAA,IAAKoB,IAAAA,MAAOC,IAAAA,SAEdV,UAAUC,IAAId,KAAKJ,KAAK4B,6BAC7BzB,OAAOiB,EAAOS,gBACT,iBACAH,cACCC,gBAGNxB,OAAOC,KAAK0B,qBAAuBvB,OAAMD,aAC3CU,mBAAqBG,OACrBY,cAAgBX,uDAGNY,IAAAA,QAASC,IAAAA,eACjBC,sBAAsB,cACrBC,GAAKC,EAAKL,gBACMK,EAAKN,oBAAnBvB,IAAAA,KAAMD,IAAAA,IACR+B,EAAIL,EAAUzB,EACd+B,EAAIL,EAAU3B,SACbH,OAAOgC,EAAGN,YACNQ,WACDC,8CAMJP,GAAsC3B,KAAtC2B,cAAef,EAAuBZ,KAAvBY,kBACjBe,aAAyB9B,UACZgB,UAAUsB,OAAO,oBAC/BvB,mBAAqB,OACZO,WAAWiB,YAAYT,QAChCA,cAAgB,oDAGLC,KAAAA,QAASC,IAAAA,OACnB7B,MAAK2B,wBAAyB9B,YAC/BwC,gBAAiBT,UAASC,iEAI3B7B,MAAKsC,SAAiBtC,KAAKsC,eAC1BA,SAAWtC,KAAKJ,KAAK2C,kBAAoBvC,KAAKL,QAAQ6C,iBAAiBxC,KAAKJ,KAAK2C,mBAAqBvC,KAAKL,QAAQ2C,SACjHtC,KAAKsC,qEAINA,EAAWtC,KAAKyC,6BAChBC,KAAKJ,GAAUK,QAAQ,SAACZ,MACpBa,GAAab,EAAGN,MAAhBmB,QACHA,IAAyB,WAAbA,IAAuBb,EAAGN,MAAMmB,SAAW,cACzDC,iBAAiB,YAAaC,EAAKxC,0BAC7BuC,iBAAiB,YAAaC,EAAKvC,0BACnCsC,iBAAiB,UAAWC,EAAK1C"}